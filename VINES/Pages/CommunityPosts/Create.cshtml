@page
@model VINES.Pages.CommunityPosts.CreateModel
@using Microsoft.AspNetCore.Authorization
@inject IAuthorizationService AuthorizationService
@{
}

@if ((await AuthorizationService.AuthorizeAsync(User, "AdminOnly")).Succeeded)
{

<br />  
<h2 class="text-info">Create New Community Post</h2>  
<br />  
  
<div class="border container" style="padding:30px;">  
    <form method="post">  
        <div class="form-group row">  
            <div class="col-4">  
                <label asp-for="communityPost.communityPostTitle"></label>  
            </div>  
            <div class="col-6">  
                <input asp-for="communityPost.communityPostTitle" class="form-control" name="title" />  
            </div>  
        </div>  
         <div class="form-group row">  
            <div class="col-4">  
                <label asp-for="communityPost.communityPostCategory"></label>  
            </div>  
            <div class="col-6">  
                <select asp-for="communityPost.communityPostCategoryID" name="catID">
                    @foreach (var category in Model.categories)
                    {
                        <option value="@category.communityPostCategoryID">@category.communityPostCategory</option>
                    }
                </select>  
            </div>  
        </div>  
  
        <div class="form-group row">  
            <div class="col-4">  
                <label asp-for="communityPost.communityPostContent"></label>  
            </div>
            <div class="col-6">  
                <textarea asp-for="communityPost.communityPostContent" class="form-control" name="content"></textarea>
            </div>  
        </div>  
  
        <div class="form-group row">  
            <div class="col-3 offset-4">  
                <input type="submit" value="Create" class="btn btn-primary form-control" />  
            </div>  
            <div class="col-3">  
                <a asp-page="Index" class="btn btn-success form-control">Back to Index</a>  
            </div>  
        </div>  
    </form>  
</div>  
}
else {
    @if (User.Identity.IsAuthenticated && User.IsInRole("Patient")) {
        
        Response.Redirect("/patientLanding");
    }
        else if (User.Identity.IsAuthenticated && User.IsInRole("Advertiser")) {
        
        Response.Redirect("/advertiserLanding");
    }
        else{
        Response.Redirect("/Index");
    }
}